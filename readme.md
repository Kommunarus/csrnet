# CSRNet для подсчёта объектов

## Обзор

Этот проект реализует подсчёт объектов с использованием CSRNet, глубокой нейронной сети, предназначенной для оценки карт плотности и подсчёта объектов. Подход использует точечные аннотации в центрах объектов вместо ограничивающих прямоугольников или масок, что особенно полезно, когда объекты значительно перекрываются.

## Постановка задачи

В определённых задачах компьютерного зрения цель состоит в том, чтобы подсчитать количество объектов на изображении, где форма не является критичной. Традиционные методы аннотирования с использованием ограничивающих прямоугольников или сегментационных масок становятся избыточными в таких случаях. Аннотирование ограничивающими прямоугольниками может быть даже нежелательным, когда объекты сильно перекрываются, что затрудняет для сети их различение.

Для таких сценариев точечная разметка в центрах объектов или в ключевых точках обеспечивает более эффективное решение. Такой подход был применен для подсчёта количества балок на строительных фотографиях.

## Датасет
(Архив с разметкой: [ds.zip](ds.zip))

Был собран датасет из 60 изображений и размечен центральными точками боковоых граней балок:

<div align="center">
  <img src="pic_ds/pic1.png" width="300" alt="Пример датасета 1">
  <img src="pic_ds/pic2.png" width="300" alt="Пример датасета 2">
  <img src="pic_ds/pic3.png" width="300" alt="Пример датасета 3">
</div>

Результатом стал небольшой датасет с точечными аннотациями:

<div align="center">
  <img src="pic_ds/pic4.png" width="400" alt="Размеченный датасет">
</div>

### Разделение данных
- Обучающая выборка: 53 изображения
- Тестовая выборка: 6 изображений

## Модель

Использовалась архитектура CSRNet, которая предсказывает карты плотности вероятности объектов. CSRNet объединяет сверточные слои с расширением и фронтенд на основе VGG для получения высокоразрешающих карт плотности.

## Результаты

Модель показала многообещающие результаты на тестовой выборке с метрикой MAE (средняя абсолютная ошибка), измеряющей разницу между предсказанными и фактическими значениями количества объектов:

<div align="center">
  <img src="pic_test/test_0.png" width="250" alt="Тестовый результат 0">
  <img src="pic_test/test_1.png" width="250" alt="Тестовый результат 1">
  <img src="pic_test/test_2.png" width="250" alt="Тестовый результат 2">
</div>

<div align="center">
  <img src="pic_test/test_3.png" width="250" alt="Тестовый результат 3">
  <img src="pic_test/test_4.png" width="250" alt="Тестовый результат 4">
  <img src="pic_test/test_5.png" width="250" alt="Тестовый результат 5">
</div>

Несмотря на обучение всего на ~50 изображениях, модель демонстрирует точные возможности подсчёта объектов. На нескольких тестовых изображениях предсказанное количество балок очень близко к размеченному. Точность должна улучшиться при увеличении размера датасета.

## Метрики

- **Метрика**: MAE (средняя абсолютная ошибка) для предсказания количества объектов
- **Обучение**: Выполнялось на 53 изображениях
- **Тестирование**: Оценивалось на 6 изображениях

## Ключевые преимущества

1. **Эффективная разметка**: Точечные аннотации быстрее и проще, чем ограничивающие прямоугольники
2. **Обработка перекрытий**: Лучшая производительность с перекрывающимися объектами по сравнению с методами на основе прямоугольников
3. **Масштабируемость**: Точность улучшается с увеличением датасета
4. **Надежность**: Эффективна даже с ограниченными обучающими данными

## Перспективы развития

- Расширить датасет большим количеством разнообразных изображений
- Настроить гиперпараметры для лучшей производительности
- Исследовать перенос обучения из аналогичных доменов